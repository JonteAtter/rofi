---
title: "Developing with rofi"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{developing}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, echo = FALSE, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
  )
library(flair)
```

Okay, so it is time to start writing some `rofi` code of your own. As
previously mentioned, `rofi` is quite opinionated about directory
structure and coding style that should make it easier for those just
starting out to do just that, get started. 

We believe that R code is best expressed in functions. A function is
basically a reusable piece of code, that uses some input (provided in
the form of arguments) to produce some output. Often, functions also
work in isolation and without side effects, meaning that whatever
happens inside a function does not affect the environment outside of
that function. 

We think that there should be one function per file (with few
exceptions, for example if you want to collect many very short and
related functions in one file). This style makes it easier for several
persons to work together on the same codebase.

So, let's create your first function. At some point you probably want
to select just a few of all the variables in the complete dataset,
because you do not need all of them for your particular project. Let's
say that this function "prepares" the data for further analyses. So:

```{r}
library(rofi)
create_function("Prepare data")
```

This should create a file called `prepare_data.R` in the directory
`functions` and open that file in your editor. It should look
something like this:

```{r, include = FALSE}
#' Prepare Data
#'
#' Write a short description of your function here 
#' @param x Describe argument x here 
#' @export 
prepare_data <- function(x) {
    ## Replace with the contents of your function
    y <- x + 1
    return (y)
}
```

Now. Replace `Write a short description of your function here` with a
short description of what your function does (maybe you wonder what
the weird "#'" and "@param" and so on comes from. Those are from
`roxygen`, a way of documenting R code for packages. See
https://r-pkgs.org/man.html for details). You could for example write
"Prepare my dataset for analysis by selecting only required
variables". The file would then look like this:

```{r prepare-1, include = FALSE}
#' Prepare Data
#'
#' Prepare my dataset for analysis by selecting only required variables
#' @param x Describe argument x here 
#' @export 
prepare_data <- function(x) {
    ## Replace with the contents of your function
    y <- x + 1
    return (y)
}
```

```{r, echo = FALSE}
decorate("prepare-1") %>% flair_lines(3)
```

The "@param" denotes documentation of a single argument, in this case
called `x`. In this case `x` is a very uninformative argument name, so
let's rename it to something more informative and intuitive, for
example `dataset`. Let's also describe this argument, for example "The
complete dataset":

```{r prepare-2, include = FALSE}
#' Prepare Data
#'
#' Prepare my dataset for analysis by selecting only required variables
#' @param dataset The complete dataset.
#' @export 
prepare_data <- function(dataset) {
    ## Replace with the contents of your function
    y <- x + 1
    return (y)
}
```
